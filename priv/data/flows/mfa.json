{
  "expire_after_minutes" : 10080,
  "uuid" : "b012583a-00ea-4b60-baf3-2860e327b64c",
  "language" : "base",
  "type" : "messaging",
  "spec_version" : "13.1.0",
  "name" : "MFA Flow",
  "localization" : {

  },
  "_ui" : {
    "nodes" : {
      "0583bc51-05f4-4773-a359-90ec76f036c5" : {
        "position" : {
          "left" : 160,
          "top" : 220
        },
        "config" : {

        },
        "type" : "split_by_webhook"
      },
      "829e26b9-eda5-435b-bfdd-f8a840eb110b" : {
        "position" : {
          "top" : 480,
          "left" : 200
        },
        "type" : "execute_actions"
      },
      "646aeef1-f3b6-4337-998f-f1a529a63117" : {
        "position" : {
          "top" : 40,
          "left" : 300
        },
        "config" : {
          "cases" : {

          }
        },
        "type" : "wait_for_response"
      },
      "30f6e7cd-6f14-4ba8-a668-181b3321844b" : {
        "position" : {
          "top" : 0,
          "left" : 40
        },
        "type" : "execute_actions"
      },
      "cec753d0-84b2-4c6d-8848-c7b22d5554ec" : {
        "position" : {
          "left" : 540,
          "top" : 380
        },
        "type" : "execute_actions"
      }
    }
  },
  "nodes" : [
    {
      "exits" : [
        {
          "uuid" : "dc220659-cd3d-4cdc-9950-fcf07829035d",
          "destination_uuid" : "646aeef1-f3b6-4337-998f-f1a529a63117"
        }
      ],
      "actions" : [
        {
          "text" : "Enter your name",
          "quick_replies" : [

          ],
          "attachments" : [

          ],
          "uuid" : "52e21124-3d72-4452-b6df-acaee95aa718",
          "type" : "send_msg"
        }
      ],
      "uuid" : "30f6e7cd-6f14-4ba8-a668-181b3321844b"
    },
    {
      "router" : {
        "default_category_uuid" : "fa54ac7f-e926-4383-884b-e026a6a8b97d",
        "operand" : "@input.text",
        "cases" : [

        ],
        "type" : "switch",
        "wait" : {
          "timeout" : {
            "category_uuid" : "a3fdce22-5d5f-4bf3-8997-dc70dc05b3b5",
            "seconds" : 300
          },
          "type" : "msg"
        },
        "categories" : [
          {
            "name" : "All Responses",
            "exit_uuid" : "2939ca7c-f2a9-47e6-9f3d-04c8c6e86add",
            "uuid" : "fa54ac7f-e926-4383-884b-e026a6a8b97d"
          },
          {
            "name" : "No Response",
            "exit_uuid" : "9b7aab0e-39bc-4e3e-bdab-0e259c57f1dd",
            "uuid" : "a3fdce22-5d5f-4bf3-8997-dc70dc05b3b5"
          }
        ],
        "result_name" : "Name"
      },
      "actions" : [

      ],
      "exits" : [
        {
          "destination_uuid" : "0583bc51-05f4-4773-a359-90ec76f036c5",
          "uuid" : "2939ca7c-f2a9-47e6-9f3d-04c8c6e86add"
        },
        {
          "destination_uuid" : "0583bc51-05f4-4773-a359-90ec76f036c5",
          "uuid" : "9b7aab0e-39bc-4e3e-bdab-0e259c57f1dd"
        }
      ],
      "uuid" : "646aeef1-f3b6-4337-998f-f1a529a63117"
    },
    {
      "router" : {
        "type" : "switch",
        "default_category_uuid" : "80d9b939-958a-4317-a3fb-6cd9066f291d",
        "cases" : [
          {
            "category_uuid" : "8df9d21b-c4aa-4358-ac40-7c073b3155ca",
            "type" : "has_only_text",
            "arguments" : [
              "Success"
            ],
            "uuid" : "c3fe6baa-f8fc-4332-bdb5-e13ffe2ada41"
          }
        ],
        "categories" : [
          {
            "name" : "Success",
            "exit_uuid" : "3092d313-43fb-4ddd-a305-5a0d234384e8",
            "uuid" : "8df9d21b-c4aa-4358-ac40-7c073b3155ca"
          },
          {
            "name" : "Failure",
            "exit_uuid" : "68b709b8-7f12-4778-a32a-c44c567e7151",
            "uuid" : "80d9b939-958a-4317-a3fb-6cd9066f291d"
          }
        ],
        "operand" : "@results.survey.category"
      },
      "actions" : [
        {
          "uuid" : "717327da-53e2-4c5e-af86-15d0896b99a6",
          "body" : "@(json(object(\n  \"contact\", object(\n    \"uuid\", contact.uuid, \n    \"name\", contact.name, \n    \"urn\", contact.urn\n  ),\n  \"flow\", object(\n    \"uuid\", run.flow.uuid, \n    \"name\", run.flow.name\n  ),\n  \"results\", foreach_value(results, extract_object, \"value\", \"category\")\n)))",
          "type" : "call_webhook",
          "method" : "PATCH",
          "url" : "https:\/\/api.glific.test:4000\/webhook\/survey",
          "result_name" : "survey",
          "headers" : {
            "File" : "stir_webhook.ex",
            "Function" : "webhook_stir",
            "Module" : "Stir.Webhook"
          }
        }
      ],
      "exits" : [
        {
          "destination_uuid" : "829e26b9-eda5-435b-bfdd-f8a840eb110b",
          "uuid" : "3092d313-43fb-4ddd-a305-5a0d234384e8"
        },
        {
          "destination_uuid" : "cec753d0-84b2-4c6d-8848-c7b22d5554ec",
          "uuid" : "68b709b8-7f12-4778-a32a-c44c567e7151"
        }
      ],
      "uuid" : "0583bc51-05f4-4773-a359-90ec76f036c5"
    },
    {
      "exits" : [
        {
          "destination_uuid" : null,
          "uuid" : "28301c06-6d43-4485-a856-6c0fb3420152"
        }
      ],
      "actions" : [
        {
          "uuid" : "f9deb596-e3ba-4d21-b5f8-639c8b17e81c",
          "type" : "send_msg",
          "quick_replies" : [

          ],
          "text" : "The webhook called failed, so sorry. please try again",
          "attachments" : [

          ]
        }
      ],
      "uuid" : "cec753d0-84b2-4c6d-8848-c7b22d5554ec"
    },
    {
      "exits" : [
        {
          "uuid" : "566fd6e8-90e6-452e-99fc-5287faf90b56",
          "destination_uuid" : null
        }
      ],
      "actions" : [
        {
          "uuid" : "f574a492-6984-4cd2-9079-86d32d08e368",
          "attachments" : [

          ],
          "text" : "The webhook was a success, the results are: @webhook_result",
          "type" : "send_msg",
          "quick_replies" : [

          ]
        }
      ],
      "uuid" : "829e26b9-eda5-435b-bfdd-f8a840eb110b"
    }
  ],
  "vars" : [
    "b012583a-00ea-4b60-baf3-2860e327b64c"
  ]
}
